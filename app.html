<!doctype html>
<html lang="pt-BR">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Kick-Off Meeting Sherwin Willians</title>

  <meta name="description" content="App do Kick-Off Meeting Sherwin Willians." />
  <meta name="theme-color" content="#f5a623" />
  <link rel="apple-touch-icon" sizes="180x180" href="./icons/icon-192.svg" />

  <link rel="manifest" href="./manifest.webmanifest" />
  <link rel="icon" type="image/svg+xml" href="./icons/icon-192.svg" />

  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet" />
  <script src="https://unpkg.com/lucide@latest"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
  <script>
    // Define worker path for PDF.js
    pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';
  </script>

  <script>
    (function () {
      const BUILD = '4';
      try {
        const url = new URL(window.location.href);
        const force = url.searchParams.get('forceUpdate') === '1';
        const key = 'app_build';
        const prev = localStorage.getItem(key);

        if (force || prev !== BUILD) {
          localStorage.setItem(key, BUILD);
          const tasks = [];

          if ('caches' in window) {
            tasks.push(
              caches.keys().then((keys) => Promise.all(keys.map((k) => caches.delete(k))))
            );
          }

          if ('serviceWorker' in navigator) {
            tasks.push(
              navigator.serviceWorker.getRegistrations().then((regs) => Promise.all(regs.map((r) => r.unregister())))
            );
          }

          Promise.allSettled(tasks).finally(() => {
            url.searchParams.delete('forceUpdate');
            url.searchParams.set('v', BUILD);
            url.searchParams.set('reload', String(Date.now()));
            window.location.replace(url.toString());
          });
          return;
        }

        if (url.searchParams.get('v') !== BUILD) {
          url.searchParams.set('v', BUILD);
          window.location.replace(url.toString());
        }
      } catch (e) { }
    })();
  </script>

  <link rel="stylesheet" href="./styles.css?v=4" />
</head>

<body class="home-page">
  <main class="app-shell">
    <section class="app-card" aria-label="Kick-Off Meeting Sherwin Willians">
      <header class="home-header">
        <div class="home-header-main">
          <div class="home-title-block">
            <div class="home-logo-wrapper" aria-hidden="true">
              <img src="./assets/logos/forge-ahead.png" alt="FORGE Ahead" class="home-logo" />
            </div>
            <h1 class="home-title" data-i18n="homeTitle" hidden>Kick-Off Meeting Sherwin Willians</h1>
            <p class="home-date" data-i18n="homeDate" hidden>11-14 de Março, 2026</p>
          </div>
          <div class="home-header-controls">
            <button class="theme-toggle" type="button" aria-label="Alternar tema claro/escuro">
              <span class="theme-toggle-icon" aria-hidden="true">
                <i data-lucide="moon"></i>
              </span>
            </button>
            <div class="lang-switcher" role="tablist" aria-label="Selecionar idioma">
              <button class="lang-pill is-active" type="button" role="tab" aria-selected="true">PT</button>
              <button class="lang-pill" type="button" role="tab" aria-selected="false">ES</button>
              <button class="lang-pill" type="button" role="tab" aria-selected="false">EN</button>
            </div>
          </div>
        </div>
      </header>

      <div class="content-container">
        <section class="home-section" data-view="agenda">
          <!-- Notices Section Moved Inside Agenda -->
          <div class="notices-section">
            <header class="section-header notices-header">
              <h2 class="section-title" data-i18n="noticesTitle">Avisos Importantes</h2>
              <button type="button" class="notices-toggle" aria-label="Expandir/Recolher avisos">
                <i data-lucide="chevron-down"></i>
              </button>
            </header>
            <div class="announcement-list" id="announcement-list"></div>
          </div>

          <header class="section-header">
            <h2 class="section-title" data-i18n="agendaTitle">Agenda</h2>
          </header>
          <div class="day-tabs" role="tablist" aria-label="Selecionar dia da agenda">
            <button class="day-pill" type="button" role="tab" aria-selected="false" data-day="sunday"
              data-i18n="sunday">
              Domingo
            </button>
            <button class="day-pill is-active" type="button" role="tab" aria-selected="true" data-day="monday"
              data-i18n="monday">
              Segunda
            </button>
            <button class="day-pill" type="button" role="tab" aria-selected="false" data-day="tuesday"
              data-i18n="tuesday">
              Terça
            </button>
            <button class="day-pill" type="button" role="tab" aria-selected="false" data-day="wednesday"
              data-i18n="wednesday">
              Quarta
            </button>
          </div>

          <div class="schedule-list" id="schedule-list" aria-live="polite">
            <!-- Conteúdo da agenda é preenchido via JavaScript para cada dia -->
          </div>
        </section>

        <section class="home-section is-hidden" data-view="mapa">


          <div class="map-viewer-container">
            <div class="zoom-indicator">100%</div>
            <div class="canvas-wrapper">
              <canvas id="pdf-render"></canvas>
            </div>
            <div class="map-controls">
              <button type="button" class="map-control-btn" id="zoom-in" aria-label="Zoom In">
                <i data-lucide="zoom-in"></i>
              </button>
              <button type="button" class="map-control-btn" id="zoom-out" aria-label="Zoom Out">
                <i data-lucide="zoom-out"></i>
              </button>
            </div>
          </div>

          <div class="locations-section">
            <h3 class="section-subtitle" data-i18n="locationsTitle">Locais</h3>
            <div class="locations-grid" id="locations-grid">
              <!-- JS rendered cards -->
            </div>
          </div>
        </section>

        <section class="home-section is-hidden" data-view="fotos">

          <div class="day-tabs photo-tabs" role="tablist" aria-label="Filtrar fotos por dia">
            <button class="day-pill is-active" type="button" role="tab" data-photo-day="all" data-i18n="allPhotos">
              Todos
            </button>
            <button class="day-pill" type="button" role="tab" data-photo-day="monday" data-i18n="monday">
              Segunda
            </button>
            <button class="day-pill" type="button" role="tab" data-photo-day="tuesday" data-i18n="tuesday">
              Terça
            </button>
            <button class="day-pill" type="button" role="tab" data-photo-day="wednesday" data-i18n="wednesday">
              Quarta
            </button>
          </div>

          <div class="photos-grid" id="photos-grid">
            <!-- JS Rendered Content -->
          </div>
        </section>

        <section class="home-section is-hidden" data-view="networking">
          <header class="section-header">
            <div class="section-title-wrap">
              <h2 class="section-title" data-i18n="networkingTitle">Networking</h2>
              <span class="networking-counter" id="networking-counter"></span>
            </div>
          </header>

          <div class="search-bar-container">
            <div class="search-input-wrapper">
              <i data-lucide="search" class="search-icon"></i>
              <input type="text" id="networking-search" class="search-input" placeholder="Buscar por nome ou país..."
                data-i18n-placeholder="searchPlaceholder">
            </div>
          </div>

          <div class="networking-list" id="networking-list">
            <!-- JS Rendered Participants -->
          </div>
        </section>
        <nav class="bottom-nav" aria-label="Navegação principal do app">
          <button class="bottom-nav-item is-active" type="button" data-view-target="agenda">
            <span class="bottom-nav-icon" aria-hidden="true">
              <i data-lucide="calendar"></i>
            </span>
            <span class="bottom-nav-label" data-i18n="navAgenda">Agenda</span>
          </button>
          <button class="bottom-nav-item" type="button" data-view-target="mapa">
            <span class="bottom-nav-icon" aria-hidden="true">
              <i data-lucide="map"></i>
            </span>
            <span class="bottom-nav-label" data-i18n="navMap">Mapa</span>
          </button>
          <button class="bottom-nav-item" type="button" data-view-target="fotos">
            <span class="bottom-nav-icon" aria-hidden="true">
              <i data-lucide="image"></i>
            </span>
            <span class="bottom-nav-label" data-i18n="navPhotos">Fotos</span>
          </button>
          <button class="bottom-nav-item" type="button" data-view-target="networking">
            <span class="bottom-nav-icon" aria-hidden="true">
              <i data-lucide="users"></i>
            </span>
            <span class="bottom-nav-label" data-i18n="navNetworking">Networking</span>
          </button>
        </nav>
      </div>
    </section>

    <dialog id="app-modal" class="modal app-modal">
      <div class="modal-content">
        <header class="modal-header">
          <h3 id="modal-title" class="modal-title"></h3>
          <button type="button" class="modal-close" aria-label="Fechar modal">
            <i data-lucide="x"></i>
          </button>
        </header>
        <div class="modal-body">
          <p id="modal-description" class="modal-description"></p>
          <p id="modal-participants" class="modal-participants"></p>
          <div class="modal-info">
            <div id="modal-time" class="modal-meta-row modal-time">
              <span class="modal-meta-icon" aria-hidden="true"><i data-lucide="clock"></i></span>
              <span id="modal-time-text"></span>
            </div>
            <div id="modal-location" class="modal-meta-row modal-location">
              <span class="modal-meta-icon" aria-hidden="true"><i data-lucide="map-pin"></i></span>
              <span id="modal-location-text"></span>
            </div>
          </div>
        </div>
        <div id="modal-actions" class="modal-actions"></div>
      </div>
    </dialog>
  </main>

  <script src="https://unpkg.com/@supabase/supabase-js@2/dist/umd/supabase.js"></script>
  <script src="./app.js?v=4" type="module"></script>
</body>

</html>